<?php
#Classe User pour gestion de l'utilisateur (Ajout, Suppression, Modification)
class User
	{
		#Déclaration des attributs en privé
		private $pseudo;
		private $nom;
		private $prenom;
		private $team;
		private $droit;

		#Accesseurs pour les attributs
		public function getPseudo()
		{
			return $this->pseudo;
		}

		public function getNom()
		{
			return $this->nom;
		}

		public function getPrenom()
		{
			return $this->prenom;
		}

		public function getTeam()
		{
			return $this->team;
		}	
		
		#Constructeur avec les informations utilisateurs en paramètres
		public function User($pseudo_user, $prenom_user, $nom_user, $team_user, $right_user)
		{
			$this->pseudo = $pseudo_user;
			$this->nom = $nom_user;
			$this->prenom = $prenom_user;
			$this->team = $team_user;
			$this->droit = $right_user;
		}
		
		#Fonction AddUser avec en paramètre l'objet de connexion PDO Mysql
		public function AddUser($bdd)
		{
			$result = $bdd->prepare("INSERT INTO user (User_Name, User_FirstName, User_Login, User_EquipeID, User_Rights) VALUES ('".$this->nom."','".$this->prenom."','".$this->pseudo."','".$this->team."','".$this->droit."')");
			$result->execute();
		}
		#Fonction EditUser avec en paramètre l'objet de connexion PDO Mysql
		public function EditUser($bdd,$id_user)
		{
			$edit = $bdd->prepare("UPDATE user SET User_Name = ?, User_FirstName = ?, User_Login = ?, User_EquipeID = ?, User_Rights = ? WHERE User_ID =".$id_user."");
			$edit->execute(array($this->nom,$this->prenom,$this->pseudo,$this->team,$this->droit));
		}		
		#Fonction GetUser avec en paramètre l'objet de connexion PDO Mysql et le login User
		public function GetUser($bdd, $login)
		{
			$get = $bdd->query("SELECT * FROM user WHERE User_Login ='".$login."'");
			$get->execute();
			while ($donnees=$get->fetch())
			{
				$this->pseudo = $donnees['User_Login'];
				$this->nom = $donnees['User_Name'];
				$this->prenom = $donnees['User_FirstName'];
				$this->team = $donnees['User_EquipeID'];
				$this->droit = $donnees['User_Rights'];
			}
		}
		
		#Methode pour vérifier si l'utilisateur existe déjà à partir du login
		public function VerifyUser($bdd)
		{
			$get = $bdd->query("SELECT * FROM user WHERE User_Login ='".$this->pseudo."'");
			$get->execute();
			$donnees=$get->fetch();
			if ($donnees==null)
			{
				return false;
			}	
			else
			{
				return true;
			}
		}
		
		#Méthode DelUser avec en paramètre l'objet de connexion PDO Mysql	
		public function DelUser($bdd)
		{
			$del= $bdd->query("DELETE FROM user WHERE User_Login ='".$this->login."'");
			$del->execute();
		}		
		
		#Destructeur de la classe User
		public function __destruct()
		{			
		}
	}
?>